\section{Affine transformation}

Affine transformation matrix for 3D space is a $4 \times 4$ matrix
\begin{equation}\label{eq:matrix:affine}
  A = \begin{bmatrix}
    1       & 0 & 0  & 0 \\
    \vec{A} &   & A' &   \\
  \end{bmatrix},
  \quad A' \in \mathbb{R}^{3 \times 3},
  \quad \left| A \right| \neq 0.
\end{equation}
The generative model should accept affine transformation as an argument
\begin{equation*}
  G\left( s; A \right) = A \cdot G\left( s \right).
\end{equation*}

We need to define matrix $\Lambda_v$ with coefficients for
a vertex $v \in V$
\begin{equation*}
  \Lambda_v = \begin{bmatrix}
    1               & 0               & \dots & 0 \\
    \lambda^0_{v_x} & \lambda^1_{v_x} & \dots & \lambda^n_{v_x} \\
    \lambda^0_{v_y} & \lambda^1_{v_y} & \dots & \lambda^n_{v_y} \\
    \lambda^0_{v_z} & \lambda^1_{v_z} & \dots & \lambda^n_{v_z} \\
  \end{bmatrix}.
\end{equation*}

Componentwise notation of the model
generated with parameters $s$ and affine transformation matrix $A$
is
\begin{equation*}
  G_{v_i}\left( s; A \right)
  = A_i \cdot G_v\left( s \right)
  \quad i \in I.
\end{equation*}
After replacing $G_v\left( s \right)$ by its value we get
a bilinear representation of the entity
\begin{equation*}
  G_{v_i}\left( s; A \right)
  = A_i \cdot \Lambda_v \cdot s,
  \quad i \in I.
\end{equation*}
Unfolded
\begin{equation*}
  G_{v_i}\left( s; A \right)
  = \left\langle a^0_i, a_i^x, a_i^y, a_i^z \right\rangle
    \cdot \begin{bmatrix}
      1               & 0               & \dots & 0 \\
      \lambda^0_{v_x} & \lambda^1_{v_x} & \dots & \lambda^n_{v_x} \\
      \lambda^0_{v_y} & \lambda^1_{v_y} & \dots & \lambda^n_{v_y} \\
      \lambda^0_{v_z} & \lambda^1_{v_z} & \dots & \lambda^n_{v_z} \\
    \end{bmatrix}
    \cdot \begin{bmatrix}
      1 \\
      s_1 \\
      \vdots \\
      s_n
    \end{bmatrix}.
\end{equation*}
As a sum
\begin{equation*}
  G_{v_i}\left( s; A \right)
  = \sum\limits_{j = 0}^{n} \sum\limits_{k = 0}^{3}
    s_{j} \cdot \lambda^{j}_{v_k} \cdot A_i^{k}.
\end{equation*}
